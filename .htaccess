########################################
# üîê SEGURIDAD B√ÅSICA (tu configuraci√≥n original)
########################################

# Bloquear acceso a archivos sensibles
<FilesMatch "\.(env|git|yml|log|sql|sh)$">
  Order allow,deny
  Deny from all
</FilesMatch>

# Evitar listado de directorios
Options -Indexes

# Proteger archivos ocultos (.htaccess, .htpasswd, etc.)
<Files ~ "^\.ht">
  Order allow,deny
  Deny from all
</Files>

########################################
# üõ°Ô∏è MEJORAS DE SEGURIDAD (simplificadas)
########################################

# Headers de seguridad b√°sicos y seguros
<IfModule mod_headers.c>
    # Prevenir clickjacking
    Header always append X-Frame-Options SAMEORIGIN
    
    # Prevenir XSS attacks
    Header set X-XSS-Protection "1; mode=block"
    
    # Prevenir MIME type sniffing
    Header set X-Content-Type-Options nosniff
    
    # Pol√≠tica de referrer
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Ocultar informaci√≥n del servidor
    Header unset Server
    Header unset X-Powered-By
</IfModule>

########################################
# üöÄ RENDIMIENTO Y OPTIMIZACI√ìN (tu configuraci√≥n mejorada)
########################################

# Activar compresi√≥n GZIP (tu configuraci√≥n + mejoras)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/css application/javascript application/json image/svg+xml image/webp
  
  # Tipos adicionales seguros
  AddOutputFilterByType DEFLATE text/xml application/xml application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml application/atom+xml
  AddOutputFilterByType DEFLATE font/ttf font/otf font/eot font/woff font/woff2
</IfModule>

# Cache de archivos est√°ticos (tu configuraci√≥n + mejoras)
<IfModule mod_expires.c>
  ExpiresActive On
  
  # Tu configuraci√≥n original de im√°genes (mantenida exacta)
  <Directory "/home3/ajupam/public_html/images">
    ExpiresActive On
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/webp "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
  </Directory>
  
  # Cache global para otros recursos (seguro)
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"
  ExpiresByType application/pdf "access plus 1 month"
  
  # NO cachear p√°ginas de error (importante)
  <Directory "/home3/ajupam/public_html/error">
    ExpiresActive Off
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires 0
  </Directory>
</IfModule>

########################################
# üîÅ REDIRECCIONES Y REESCRITURA (tu configuraci√≥n ORIGINAL)
########################################

# ‚ö†Ô∏è MANTENER EXACTAMENTE TU CONFIGURACI√ìN ORIGINAL

# Redirigir HTTP a HTTPS
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

# Redirigir /sponsors/ a su landing
RewriteRule ^sponsors/?$ /sponsors/index.html [L]

# Ocultar extensiones en /sponsors/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^sponsors/([a-zA-Z0-9_-]+)$ sponsors/$1.html [L]

########################################
# ‚ö†Ô∏è P√ÅGINAS DE ERROR PERSONALIZADAS (tu configuraci√≥n original)
########################################

ErrorDocument 404 /error/404.html
ErrorDocument 403 /error/403.html
ErrorDocument 500 /error/500.html

########################################
# üîí PROTECCIONES B√ÅSICAS ADICIONALES
########################################

# Proteger archivos de configuraci√≥n
<Files "*.yml">
    Order allow,deny
    Deny from all
</Files>

<Files "*.json">
    Order allow,deny
    Deny from all
</Files>

# Permitir archivos espec√≠ficos necesarios
<Files "manifest.json">
    Order deny,allow
    Allow from all
</Files>

# Proteger archivos de backup
<FilesMatch "\.(bak|backup|old|orig|save)$">
    Order allow,deny
    Deny from all
</FilesMatch>

########################################
# üìß CONFIGURACI√ìN B√ÅSICA PARA FORMULARIOS
########################################

# Headers para formularios de contacto (simplificado)
<FilesMatch "\.html$">
    <IfModule mod_headers.c>
        Header set Access-Control-Allow-Methods "POST, GET, OPTIONS"
    </IfModule>
</FilesMatch>

########################################
# üåê CONFIGURACI√ìN ARGENTINA
########################################

# Zona horaria Argentina
<IfModule mod_env.c>
    SetEnv TZ America/Argentina/Mendoza
</IfModule>

########################################
# üõ†Ô∏è MODO MANTENIMIENTO (comentado y seguro)
########################################

# Para activar mantenimiento, descomentar estas l√≠neas:
# IMPORTANTE: Reemplazar TU_IP_AQUI con tu IP real

# RewriteEngine On
# RewriteCond %{REQUEST_URI} !^/error/maintenance\.html$
# RewriteCond %{REQUEST_URI} !^/images/
# RewriteCond %{REQUEST_URI} !^/css/
# RewriteCond %{REQUEST_URI} !^/js/
# RewriteCond %{REMOTE_ADDR} !^TU_IP_AQUI$
# RewriteRule ^(.*)$ /error/maintenance.html [R=503,L]